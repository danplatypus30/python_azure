def view_vt(url):
    import os
    # pip install virustotal3(Unofficial).
    import virustotal3.core
    # url = "www.google.com"
    api_key = '***REMOVED***'

    # Data is returned as a dict. We can just iterate through to get the required information.
    analysis_result = virustotal3.core.URL(api_key).get_network_location(url)
    # try:
    #     for x in analysis_result:
    #         print(x)
    # except:
    #     print('screwed up')
    x = analysis_result['data']['attributes']['last_analysis_stats']
    print('Analysis result: {} malicious, {} harmless, {} sus, {} timeout, {} undetected'.format(x['malicious'], x['harmless'], x['suspicious'], x['timeout'], x['undetected']))

def format_dict():
    dict_raw = {"data": {"attributes": {"categories": {"BitDefender": "searchengines", "Forcepoint ThreatSeeker": "search engines and portals", "sophos": "search engines"}, "creation_date": 874296000, "jarm": "27d40d40d29d40d1dc42d43d00041d4689ee210389f4f6b4b5b1b93f92252d", "last_analysis_results": {"ADMINUSLabs": {"category": "harmless", "engine_name": "ADMINUSLabs", "method": "blacklist", "result": "clean"}, "AICC (MONITORAPP)": {"category": "harmless", "engine_name": "AICC (MONITORAPP)", "method": "blacklist", "result": "clean"}, "AegisLab WebGuard": {"category": "harmless", "engine_name": "AegisLab WebGuard", "method": "blacklist", "result": "clean"}, "AlienVault": {"category": "harmless", "engine_name": "AlienVault", "method": "blacklist", "result": "clean"}, "Antiy-AVL": {"category": "harmless", "engine_name": "Antiy-AVL", "method": "blacklist", "result": "clean"}, "Armis": {"category": "harmless", "engine_name": "Armis", "method": "blacklist", "result": "clean"}, "Artists Against 419": {"category": "harmless", "engine_name": "Artists Against 419", "method": "blacklist", "result": "clean"}, "AutoShun": {"category": "undetected", "engine_name": "AutoShun", "method": "blacklist", "result": "unrated"}, "Avira": {"category": "harmless", "engine_name": "Avira", "method": "blacklist", "result": "clean"}, "BADWARE.INFO": {"category": "harmless", "engine_name": "BADWARE.INFO", "method": "blacklist", "result": "clean"}, "Baidu-International": {"category": "harmless", "engine_name": "Baidu-International", "method": "blacklist", "result": "clean"}, "BitDefender": {"category": "harmless", "engine_name": "BitDefender", "method": "blacklist", "result": "clean"}, "BlockList": {"category": "harmless", "engine_name": "BlockList", "method": "blacklist", "result": "clean"}, "Blueliv": {"category": "harmless", "engine_name": "Blueliv", "method": "blacklist", "result": "clean"}, "Botvrij.eu": {"category": "harmless", "engine_name": "Botvrij.eu", "method": "blacklist", "result": "clean"}, "CINS Army": {"category": "harmless", "engine_name": "CINS Army", "method": "blacklist", "result": "clean"}, "CLEAN MX": {"category": "harmless", "engine_name": "CLEAN MX", "method": "blacklist", "result": "clean"}, "CMC Threat Intelligence": {"category": "malicious", "engine_name": "CMC Threat Intelligence", "method": "blacklist", "result": "phishing"}, "CRDF": {"category": "harmless", "engine_name": "CRDF", "method": "blacklist", "result": "clean"}, "Certego": {"category": "harmless", "engine_name": "Certego", "method": "blacklist", "result": "clean"}, "Comodo Site Inspector": {"category": "harmless", "engine_name": "Comodo Site Inspector", "method": "blacklist", "result": "clean"}, "Comodo Valkyrie Verdict": {"category": "undetected", "engine_name": "Comodo Valkyrie Verdict", "method": "blacklist", "result": "unrated"}, "CyRadar": {"category": "harmless", "engine_name": "CyRadar", "method": "blacklist", "result": "clean"}, "Cyan": {"category": "undetected", "engine_name": "Cyan", "method": "blacklist", "result": "unrated"}, "CyberCrime": {"category": "harmless", "engine_name": "CyberCrime", "method": "blacklist", "result": "clean"}, "Cyren": {"category": "harmless", "engine_name": "Cyren", "method": "blacklist", "result": "clean"}, "DNS8": {"category": "harmless", "engine_name": "DNS8", "method": "blacklist", "result": "clean"}, "Dr.Web": {"category": "harmless", "engine_name": "Dr.Web", "method": "blacklist", "result": "clean"}, "ESET": {"category": "harmless", "engine_name": "ESET", "method": "blacklist", "result": "clean"}, "ESTsecurity-Threat Inside": {"category": "harmless", "engine_name": "ESTsecurity-Threat Inside", "method": "blacklist", "result": "clean"}, "EmergingThreats": {"category": "harmless", "engine_name": "EmergingThreats", "method": "blacklist", "result": "clean"}, "Emsisoft": {"category": "harmless", "engine_name": "Emsisoft", "method": "blacklist", "result": "clean"}, "EonScope": {"category": "harmless", "engine_name": "EonScope", "method": "blacklist", "result": "clean"}, "Feodo Tracker": {"category": "harmless", "engine_name": "Feodo Tracker", "method": "blacklist", "result": "clean"}, "Forcepoint ThreatSeeker": {"category": "harmless", "engine_name": "Forcepoint ThreatSeeker", "method": "blacklist", "result": "clean"}, "Fortinet": {"category": "harmless", "engine_name": "Fortinet", "method": "blacklist", "result": "clean"}, "FraudScore": {"category": "harmless", "engine_name": "FraudScore", "method": "blacklist", "result": "clean"}, "FraudSense": {"category": "harmless", "engine_name": "FraudSense", "method": "blacklist", "result": "clean"}, "G-Data": {"category": "harmless", "engine_name": "G-Data", "method": "blacklist", "result": "clean"}, "Google Safebrowsing": {"category": "harmless", "engine_name": "Google Safebrowsing", "method": "blacklist", "result": "clean"}, "GreenSnow": {"category": "harmless", "engine_name": "GreenSnow", "method": "blacklist", "result": "clean"}, "Hoplite Industries": {"category": "harmless", "engine_name": "Hoplite Industries", "method": "blacklist", "result": "clean"}, "IPsum": {"category": "harmless", "engine_name": "IPsum", "method": "blacklist", "result": "clean"}, "K7AntiVirus": {"category": "harmless", "engine_name": "K7AntiVirus", "method": "blacklist", "result": "clean"}, "Kaspersky": {"category": "harmless", "engine_name": "Kaspersky", "method": "blacklist", "result": "clean"}, "Lumu": {"category": "undetected", "engine_name": "Lumu", "method": "blacklist", "result": "unrated"}, "MalBeacon": {"category": "harmless", "engine_name": "MalBeacon", "method": "blacklist", "result": "clean"}, "MalSilo": {"category": "harmless", "engine_name": "MalSilo", "method": "blacklist", "result": "clean"}, "Malc0de Database": {"category": "harmless", "engine_name": "Malc0de Database", "method": "blacklist", "result": "clean"}, "Malekal": {"category": "harmless", "engine_name": "Malekal", "method": "blacklist", "result": "clean"}, "Malware Domain Blocklist": {"category": "harmless", "engine_name": "Malware Domain Blocklist", "method": "blacklist", "result": "clean"}, "MalwareDomainList": {"category": "harmless", "engine_name": "MalwareDomainList", "method": "blacklist", "result": "clean"}, "MalwarePatrol": {"category": "harmless", "engine_name": "MalwarePatrol", "method": "blacklist", "result": "clean"}, "Malwarebytes hpHosts": {"category": "harmless", "engine_name": "Malwarebytes hpHosts", "method": "blacklist", "result": "clean"}, "Malwared": {"category": "harmless", "engine_name": "Malwared", "method": "blacklist", "result": "clean"}, "Netcraft": {"category": "undetected", "engine_name": "Netcraft", "method": "blacklist", "result": "unrated"}, "NotMining": {"category": "undetected", "engine_name": "NotMining", "method": "blacklist", "result": "unrated"}, "Nucleon": {"category": "harmless", "engine_name": "Nucleon", "method": "blacklist", "result": "clean"}, "OpenPhish": {"category": "harmless", "engine_name": "OpenPhish", "method": "blacklist", "result": "clean"}, "Opera": {"category": "harmless", "engine_name": "Opera", "method": "blacklist", "result": "clean"}, "PREBYTES": {"category": "harmless", "engine_name": "PREBYTES", "method": "blacklist", "result": "clean"}, "PhishLabs": {"category": "undetected", "engine_name": "PhishLabs", "method": "blacklist", "result": "unrated"}, "Phishing Database": {"category": "harmless", "engine_name": "Phishing Database", "method": "blacklist", "result": "clean"}, "Phishtank": {"category": "harmless", "engine_name": "Phishtank", "method": "blacklist", "result": "clean"}, "Quick Heal": {"category": "harmless", "engine_name": "Quick Heal", "method": "blacklist", "result": "clean"}, "Quttera": {"category": "harmless", "engine_name": "Quttera", "method": "blacklist", "result": "clean"}, "Rising": {"category": "harmless", "engine_name": "Rising", "method": "blacklist", "result": "clean"}, "SCUMWARE.org": {"category": "harmless", "engine_name": "SCUMWARE.org", "method": "blacklist", "result": "clean"}, "Sangfor": {"category": "harmless", "engine_name": "Sangfor", "method": "blacklist", "result": "clean"}, "SecureBrain": {"category": "harmless", "engine_name": "SecureBrain", "method": "blacklist", "result": "clean"}, "Segasec": {"category": "undetected", "engine_name": "Segasec", "method": "blacklist", "result": "unrated"}, "Snort IP sample list": {"category": "harmless", "engine_name": "Snort IP sample list", "method": "blacklist", "result": "clean"}, "Sophos": {"category": "harmless", "engine_name": "Sophos", "method": "blacklist", "result": "clean"}, "Spam404": {"category": "harmless", "engine_name": "Spam404", "method": "blacklist", "result": "clean"}, "Spamhaus": {"category": "harmless", "engine_name": "Spamhaus", "method": "blacklist", "result": "clean"}, "StopBadware": {"category": "undetected", "engine_name": "StopBadware", "method": "blacklist", "result": "unrated"}, "StopForumSpam": {"category": "harmless", "engine_name": "StopForumSpam", "method": "blacklist", "result": "clean"}, "Sucuri SiteCheck": {"category": "harmless", "engine_name": "Sucuri SiteCheck", "method": "blacklist", "result": "clean"}, "Tencent": {"category": "harmless", "engine_name": "Tencent", "method": "blacklist", "result": "clean"}, "ThreatHive": {"category": "harmless", "engine_name": "ThreatHive", "method": "blacklist", "result": "clean"}, "Threatsourcing": {"category": "harmless", "engine_name": "Threatsourcing", "method": "blacklist", "result": "clean"}, "Trustwave": {"category": "harmless", "engine_name": "Trustwave", "method": "blacklist", "result": "clean"}, "URLQuery": {"category": "harmless", "engine_name": "URLQuery", "method": "blacklist", "result": "clean"}, "URLhaus": {"category": "harmless", "engine_name": "URLhaus", "method": "blacklist", "result": "clean"}, "VX Vault": {"category": "harmless", "engine_name": "VX Vault", "method": "blacklist", "result": "clean"}, "Virusdie External Site Scan": {"category": "harmless", "engine_name": "Virusdie External Site Scan", "method": "blacklist", "result": "clean"}, "Web Security Guard": {"category": "harmless", "engine_name": "Web Security Guard", "method": "blacklist", "result": "clean"}, "Yandex Safebrowsing": {"category": "harmless", "engine_name": "Yandex Safebrowsing", "method": "blacklist", "result": "clean"}, "ZCloudsec": {"category": "harmless", "engine_name": "ZCloudsec", "method": "blacklist", "result": "clean"}, "ZDB Zeus": {"category": "harmless", "engine_name": "ZDB Zeus", "method": "blacklist", "result": "clean"}, "ZeroCERT": {"category": "harmless", "engine_name": "ZeroCERT", "method": "blacklist", "result": "clean"}, "Zerofox": {"category": "harmless", "engine_name": "Zerofox", "method": "blacklist", "result": "clean"}, "ZeusTracker": {"category": "harmless", "engine_name": "ZeusTracker", "method": "blacklist", "result": "clean"}, "desenmascara.me": {"category": "harmless", "engine_name": "desenmascara.me", "method": "blacklist", "result": "clean"}, "malwares.com URL checker": {"category": "harmless", "engine_name": "malwares.com URL checker", "method": "blacklist", "result": "clean"}, "securolytics": {"category": "harmless", "engine_name": "securolytics", "method": "blacklist", "result": "clean"}, "zvelo": {"category": "harmless", "engine_name": "zvelo", "method": "blacklist", "result": "clean"}}, "last_analysis_stats": {"harmless": 88, "malicious": 1, "suspicious": 0, "timeout": 0, "undetected": 9}, "last_dns_records": [{"ttl": 100, "type": "A", "value": "172.217.212.104"}, {"ttl": 100, "type": "A", "value": "172.217.212.103"}, {"ttl": 299, "type": "AAAA", "value": "2607:f8b0:4001:c03::6a"}, {"ttl": 299, "type": "AAAA", "value": "2607:f8b0:4001:c03::63"}, {"ttl": 100, "type": "A", "value": "172.217.212.99"}, {"ttl": 100, "type": "A", "value": "172.217.212.106"}, {"ttl": 100, "type": "A", "value": "172.217.212.105"}, {"ttl": 100, "type": "A", "value": "172.217.212.147"}, {"ttl": 299, "type": "AAAA", "value": "2607:f8b0:4001:c03::68"}, {"ttl": 299, "type": "AAAA", "value": "2607:f8b0:4001:c03::67"}], "last_dns_records_date": 1611828200, "last_https_certificate": {"cert_signature": {"signature": "5dcac09d37c3ecfab7ff1e1e4ec55702d7caf35317a1be560d38a9ccb01f347f8159747d7d52d588b76fe067e1911b438db90b6cfce5dead76db802fa24985c91064994647d6aa541ecd940d705a1ad883526a4c729d86455127a1fdf05035ae97f60ba5546403020ab664edcf391b7b20cba8681fe98d6c74a38603a16cda0e3e57818955f6dbd55167928ca386aecee4bc55e8b944b35f635e8b2009b69bbdeef7fd528f140bcc7cba8c2cb736855eaa3d6b09155d316ca5f105556b604b53862971754f0e4fb408a961713e32ab15cd081bb5d354246d3c0552b72380ea8f4421d5bfe7547e967a16b1607514ffdce8264fa63ab52d94c34fd227fdb48477", "signature_algorithm": "sha256RSA"}, "extensions": {"1.3.6.1.4.1.11129.2.4.2": "0481f200f00075009420bc1e8ed58d6c88731f828b222c0dd1da4d5e6c4f943d", "CA": True, "authority_key_identifier": {"keyid": "98d1f86e10ebcf9bec609f18901ba0eb7d09fd2b"}, "ca_information_access": {"CA Issuers": "http://pki.goog/gsr2/GTS1O1.crt", "OCSP": "http://ocsp.pki.goog/gts1o1core"}, "certificate_policies": ["2.23.140.1.2.2", "1.3.6.1.4.1.11129.2.5.3"], "crl_distribution_points": ["http://crl.pki.goog/GTS1O1core.crl"], "extended_key_usage": ["serverAuth"], "key_usage": ["ff"], "subject_alternative_name": ["www.google.com"], "subject_key_identifier": "db9bb8c1122a60e46c3027e3cb9cf9007ea17835", "tags": []}, "issuer": {"C": "US", "CN": "GTS CA 1O1", "O": "Google Trust Services"}, "public_key": {"algorithm": "EC", "ec": {"oid": "secp256r1", "pub": "0487fba6e3c537a464276c1b948179a642d821caada34a816843eaa06c60cdd96915fbafcac17d4bee43d5a9eec8a4ad6e6fd0de58aa8623d30ea17615721a2564"}}, "serial_number": "34a32da46bcec9cc05000000008591af", "signature_algorithm": "sha256RSA", "size": 1227, "subject": {"C": "US", "CN": "www.google.com", "L": "Mountain View", "O": "Google LLC", "ST": "California"}, "tags": [], "thumbprint": "c4c7f349dc7cc6dc4c51566e3612499d69ed95a7", "thumbprint_sha256": "74a5bab83a29e3da8b51acfbc6dc11698bb75013a8dc8dc5a79ba4b04f8296f2", "validity": {"not_after": "2021-03-30 12:12:59", "not_before": "2021-01-05 12:13:00"}, "version": "V3"}, "last_https_certificate_date": 1611828200, "last_modification_date": 1611828318, "last_update_date": 1568043544, "popularity_ranks": {"Cisco Umbrella": {"rank": 3, "timestamp": 1611761761}}, "registrar": "MarkMonitor Inc.", "reputation": 90, "tags": [], "total_votes": {"harmless": 24, "malicious": 3}, "whois": "Admin Country: US\nAdmin Organization: Google LLC\nAdmin State/Province: CA\nCreation Date: 1997-09-15T00:00:00-0700\nCreation Date: 1997-09-15T04:00:00Z\nDNSSEC: unsigned\nDomain Name: GOOGLE.COM\nDomain Name: google.com\nDomain Status: clientDeleteProhibited (https://www.icann.org/epp#clientDeleteProhibited)\nDomain Status: clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited\nDomain Status: clientTransferProhibited (https://www.icann.org/epp#clientTransferProhibited)\nDomain Status: clientTransferProhibited https://icann.org/epp#clientTransferProhibited\nDomain Status: clientUpdateProhibited (https://www.icann.org/epp#clientUpdateProhibited)\nDomain Status: clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited\nDomain Status: serverDeleteProhibited (https://www.icann.org/epp#serverDeleteProhibited)\nDomain Status: serverDeleteProhibited https://icann.org/epp#serverDeleteProhibited\nDomain Status: serverTransferProhibited (https://www.icann.org/epp#serverTransferProhibited)\nDomain Status: serverTransferProhibited https://icann.org/epp#serverTransferProhibited\nDomain Status: serverUpdateProhibited (https://www.icann.org/epp#serverUpdateProhibited)\nDomain Status: serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited\nName Server: NS1.GOOGLE.COM\nName Server: NS2.GOOGLE.COM\nName Server: NS3.GOOGLE.COM\nName Server: NS4.GOOGLE.COM\nName Server: ns1.google.com\nName Server: ns2.google.com\nName Server: ns3.google.com\nName Server: ns4.google.com\nRegistrant Country: US\nRegistrant Email: ca4484b9e50182bds@\nRegistrant Organization: 3307059bbb3149c4\nRegistrant State/Province: b1952dfc047df18a\nRegistrar Abuse Contact Email: abusecomplaints@markmonitor.com\nRegistrar Abuse Contact Phone: +1.2083895740\nRegistrar Abuse Contact Phone: +1.2083895770\nRegistrar IANA ID: 292\nRegistrar Registration Expiration Date: 2028-09-13T00:00:00-0700\nRegistrar URL: http://www.markmonitor.com\nRegistrar WHOIS Server: whois.markmonitor.com\nRegistrar: MarkMonitor Inc.\nRegistrar: MarkMonitor, Inc.\nRegistry Domain ID: 2138514_DOMAIN_COM-VRSN\nRegistry Expiry Date: 2028-09-14T04:00:00Z\nTech Country: US\nTech Organization: Google LLC\nTech State/Province: CA\nUpdated Date: 2019-09-09T08:39:04-0700\nUpdated Date: 2019-09-09T15:39:04Z"}, "id": "www.google.com", "links": {"self": "https://www.virustotal.com/api/v3/domains/www.google.com"}, "type": "domain"}, "links": {"self": "https://www.virustotal.com/api/v3/urls/dd014af5ed6b38d9130e3f466f850e46d21b951199d53a18ef29ee9341614eaf/network_location"}, "meta": {"count": 1}}

if __name__ == '__main__':
    view_vt("www.google.com")
    # format_dict()